<!DOCTYPE html>
<html lang="en">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <title>Sports Equipment Portal</title>
Â  Â  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
Â  Â  <style>
Â  Â  Â  Â  * {
Â  Â  Â  Â  Â  Â  margin: 0;
Â  Â  Â  Â  Â  Â  padding: 0;
Â  Â  Â  Â  Â  Â  box-sizing: border-box;
Â  Â  Â  Â  }

Â  Â  Â  Â  body {
Â  Â  Â  Â  Â  Â  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
Â  Â  Â  Â  Â  Â  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
Â  Â  Â  Â  Â  Â  min-height: 100vh;
Â  Â  Â  Â  Â  Â  padding: 20px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .container {
Â  Â  Â  Â  Â  Â  max-width: 1200px;
Â  Â  Â  Â  Â  Â  margin: 0 auto;
Â  Â  Â  Â  Â  Â  background: white;
Â  Â  Â  Â  Â  Â  border-radius: 15px;
Â  Â  Â  Â  Â  Â  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
Â  Â  Â  Â  Â  Â  overflow: hidden;
Â  Â  Â  Â  }

Â  Â  Â  Â  .header {
Â  Â  Â  Â  Â  Â  background: linear-gradient(135deg, #2c3e50, #34495e);
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  padding: 30px;
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  }

Â  Â  Â  Â  .header h1 {
Â  Â  Â  Â  Â  Â  font-size: 2.5em;
Â  Â  Â  Â  Â  Â  margin-bottom: 10px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .header p {
Â  Â  Â  Â  Â  Â  font-size: 1.1em;
Â  Â  Â  Â  Â  Â  opacity: 0.9;
Â  Â  Â  Â  }

Â  Â  Â  Â  .main-content {
Â  Â  Â  Â  Â  Â  padding: 40px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .section {
Â  Â  Â  Â  Â  Â  margin-bottom: 40px;
Â  Â  Â  Â  Â  Â  padding: 30px;
Â  Â  Â  Â  Â  Â  border-radius: 10px;
Â  Â  Â  Â  Â  Â  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
Â  Â  Â  Â  }

Â  Â  Â  Â  .equipment-issue {
Â  Â  Â  Â  Â  Â  background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  }

Â  Â  Â  Â  .active-loans {
Â  Â  Â  Â  Â  Â  background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  }

Â  Â  Â  Â  .transaction-log {
Â  Â  Â  Â  Â  Â  background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  }

Â  Â  Â  Â  .section h2 {
Â  Â  Â  Â  Â  Â  font-size: 1.8em;
Â  Â  Â  Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  gap: 10px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .form-group {
Â  Â  Â  Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .form-group label {
Â  Â  Â  Â  Â  Â  display: block;
Â  Â  Â  Â  Â  Â  margin-bottom: 8px;
Â  Â  Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  Â  Â  font-size: 1.1em;
Â  Â  Â  Â  }

Â  Â  Â  Â  .form-group input,
Â  Â  Â  Â  .form-group select {
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  padding: 12px 15px;
Â  Â  Â  Â  Â  Â  border: 2px solid rgba(255, 255, 255, 0.3);
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  font-size: 1em;
Â  Â  Â  Â  Â  Â  background: rgba(255, 255, 255, 0.2);
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  backdrop-filter: blur(10px);
Â  Â  Â  Â  }

Â  Â  Â  Â  .form-group input::placeholder {
Â  Â  Â  Â  Â  Â  color: rgba(255, 255, 255, 0.7);
Â  Â  Â  Â  }

Â  Â  Â  Â  .btn {
Â  Â  Â  Â  Â  Â  background: rgba(255, 255, 255, 0.2);
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  border: 2px solid rgba(255, 255, 255, 0.3);
Â  Â  Â  Â  Â  Â  padding: 12px 30px;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  font-size: 1em;
Â  Â  Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  Â  Â  transition: all 0.3s ease;
Â  Â  Â  Â  Â  Â  backdrop-filter: blur(10px);
Â  Â  Â  Â  }

Â  Â  Â  Â  .btn:hover {
Â  Â  Â  Â  Â  Â  background: rgba(255, 255, 255, 0.3);
Â  Â  Â  Â  Â  Â  transform: translateY(-2px);
Â  Â  Â  Â  Â  Â  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
Â  Â  Â  Â  }

Â  Â  Â  Â  .student-info {
Â  Â  Â  Â  Â  Â  background: rgba(255, 255, 255, 0.2);
Â  Â  Â  Â  Â  Â  padding: 20px;
Â  Â  Â  Â  Â  Â  border-radius: 10px;
Â  Â  Â  Â  Â  Â  margin: 20px 0;
Â  Â  Â  Â  Â  Â  backdrop-filter: blur(10px);
Â  Â  Â  Â  }

Â  Â  Â  Â  .info-grid {
Â  Â  Â  Â  Â  Â  display: grid;
Â  Â  Â  Â  Â  Â  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
Â  Â  Â  Â  Â  Â  gap: 15px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .info-item {
Â  Â  Â  Â  Â  Â  background: rgba(255, 255, 255, 0.1);
Â  Â  Â  Â  Â  Â  padding: 10px 15px;
Â  Â  Â  Â  Â  Â  border-radius: 6px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .info-label {
Â  Â  Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  Â  Â  font-size: 0.9em;
Â  Â  Â  Â  Â  Â  opacity: 0.8;
Â  Â  Â  Â  }

Â  Â  Â  Â  .info-value {
Â  Â  Â  Â  Â  Â  font-size: 1.1em;
Â  Â  Â  Â  Â  Â  margin-top: 5px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .table-container {
Â  Â  Â  Â  Â  Â  background: rgba(255, 255, 255, 0.1);
Â  Â  Â  Â  Â  Â  border-radius: 10px;
Â  Â  Â  Â  Â  Â  overflow-x: auto;
Â  Â  Â  Â  Â  Â  backdrop-filter: blur(10px);
Â  Â  Â  Â  }

Â  Â  Â  Â  table {
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  border-collapse: collapse;
Â  Â  Â  Â  }

Â  Â  Â  Â  th,
Â  Â  Â  Â  td {
Â  Â  Â  Â  Â  Â  padding: 15px;
Â  Â  Â  Â  Â  Â  text-align: left;
Â  Â  Â  Â  Â  Â  border-bottom: 1px solid rgba(255, 255, 255, 0.2);
Â  Â  Â  Â  }

Â  Â  Â  Â  th {
Â  Â  Â  Â  Â  Â  background: rgba(255, 255, 255, 0.1);
Â  Â  Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  Â  Â  font-size: 0.95em;
Â  Â  Â  Â  Â  Â  text-transform: uppercase;
Â  Â  Â  Â  Â  Â  letter-spacing: 0.5px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .status-active {
Â  Â  Â  Â  Â  Â  background: #e74c3c;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  padding: 5px 10px;
Â  Â  Â  Â  Â  Â  border-radius: 15px;
Â  Â  Â  Â  Â  Â  font-size: 0.8em;
Â  Â  Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  }

Â  Â  Â  Â  .status-returned {
Â  Â  Â  Â  Â  Â  background: #27ae60;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  padding: 5px 10px;
Â  Â  Â  Â  Â  Â  border-radius: 15px;
Â  Â  Â  Â  Â  Â  font-size: 0.8em;
Â  Â  Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  }

Â  Â  Â  Â  .return-btn {
Â  Â  Â  Â  Â  Â  background: #27ae60;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  padding: 8px 15px;
Â  Â  Â  Â  Â  Â  border-radius: 5px;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  font-size: 0.9em;
Â  Â  Â  Â  Â  Â  transition: all 0.3s ease;
Â  Â  Â  Â  }

Â  Â  Â  Â  .return-btn:hover {
Â  Â  Â  Â  Â  Â  background: #219a52;
Â  Â  Â  Â  Â  Â  transform: scale(1.05);
Â  Â  Â  Â  }

Â  Â  Â  Â  .alert {
Â  Â  Â  Â  Â  Â  padding: 15px;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  margin: 20px 0;
Â  Â  Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  }

Â  Â  Â  Â  .alert-success {
Â  Â  Â  Â  Â  Â  background: rgba(39, 174, 96, 0.2);
Â  Â  Â  Â  Â  Â  border: 2px solid rgba(39, 174, 96, 0.5);
Â  Â  Â  Â  Â  Â  color: #27ae60;
Â  Â  Â  Â  }

Â  Â  Â  Â  .alert-error {
Â  Â  Â  Â  Â  Â  background: rgba(231, 76, 60, 0.2);
Â  Â  Â  Â  Â  Â  border: 2px solid rgba(231, 76, 60, 0.5);
Â  Â  Â  Â  Â  Â  color: #e74c3c;
Â  Â  Â  Â  }

Â  Â  Â  Â  @media (max-width: 768px) {
Â  Â  Â  Â  Â  Â  .main-content {
Â  Â  Â  Â  Â  Â  Â  Â  padding: 20px;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  .header {
Â  Â  Â  Â  Â  Â  Â  Â  padding: 20px;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  .header h1 {
Â  Â  Â  Â  Â  Â  Â  Â  font-size: 2em;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  .info-grid {
Â  Â  Â  Â  Â  Â  Â  Â  grid-template-columns: 1fr;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  </style>
</head>

<body>
Â  Â  <div class="container">
Â  Â  Â  Â  <div class="header">
Â  Â  Â  Â  Â  Â  <h1>ğŸ† Sports Equipment Portal</h1>
Â  Â  Â  Â  Â  Â  <p>Hostel Sports Equipment Management System</p>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="main-content">
Â  Â  Â  Â  Â  Â  <div class="section equipment-issue">
Â  Â  Â  Â  Â  Â  Â  Â  <h2>ğŸ“¤ Issue Equipment</h2>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="form-group">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label>Roll Number</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" id="rollNo" placeholder="Enter student's roll number">
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn" onclick="lookupStudent()">Find Student</button>

Â  Â  Â  Â  Â  Â  Â  Â  <div id="studentInfo" style="display: none;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="student-info">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h3>Student Information</h3>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="info-grid">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="info-item">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="info-label">Name</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="info-value" id="studentName">-</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="info-item">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="info-label">Roll Number</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="info-value" id="studentRoll">-</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="info-item">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="info-label">Room Number</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="info-value" id="studentRoom">-</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="info-item">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="info-label">Phone Number</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="info-value" id="studentPhone">-</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="form-group">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label>Facility Type</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <select id="facilityType">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="">Select Facility</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="Sports">Sports</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="Gym">Gym</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="Music Room">Music Room</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="Pantry">Pantry</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </select>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="form-group" id="sportsEquipmentGroup" style="display: none;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label>Sports Equipment</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <select id="sportsEquipment">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="">Select Equipment</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="Basketball">Basketball</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="Football">Football</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="Volleyball">Volleyball</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="Cricket Kit">Cricket Kit</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="Badminton Rackets">Badminton Rackets (Pair)</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="Table Tennis">Table Tennis Rackets (Pair)</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </select>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn" onclick="issueEquipment()">Issue Equipment</button>
Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <div id="issueStatus"></div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="section active-loans">
Â  Â  Â  Â  Â  Â  Â  Â  <h2>ğŸ“‹ Active Equipment Loans</h2>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="table-container">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <table id="activeLoansTable">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <thead>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>Roll No</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>Name</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>Room</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>Equipment</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>Out Time</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>Duration</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>Action</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </thead>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tbody id="activeLoansBody">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td colspan="7" style="text-align: center; padding: 30px;">No active loans</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </tbody>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </table>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="section transaction-log">
Â  Â  Â  Â  Â  Â  Â  Â  <h2>ğŸ“Š Transaction History</h2>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="table-container">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <table id="transactionTable">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <thead>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>Date</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>Roll No</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>Name</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>Equipment</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>Out Time</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>In Time</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>Duration</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>Status</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </thead>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tbody id="transactionBody">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td colspan="8" style="text-align: center; padding: 30px;">No transactions yet</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </tbody>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </table>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <script>
Â  Â  Â  Â  let studentsData = {};
Â  Â  Â  Â  let transactions = [];
Â  Â  Â  Â  let activeLoans = [];

Â  Â  Â  Â  // Utility Functions
Â  Â  Â  Â  function showStatus(elementId, message, type) {
Â  Â  Â  Â  Â  Â  const element = document.getElementById(elementId);
Â  Â  Â  Â  Â  Â  element.innerHTML = `<div class="alert alert-${type}">${message}</div>`;
Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  element.innerHTML = '';
Â  Â  Â  Â  Â  Â  }, 5000);
Â  Â  Â  Â  }

Â  Â  Â  Â  function formatDateTime(date) {
Â  Â  Â  Â  Â  Â  return date.toLocaleString('en-IN', {
Â  Â  Â  Â  Â  Â  Â  Â  day: '2-digit',
Â  Â  Â  Â  Â  Â  Â  Â  month: '2-digit',
Â  Â  Â  Â  Â  Â  Â  Â  year: 'numeric',
Â  Â  Â  Â  Â  Â  Â  Â  hour: '2-digit',
Â  Â  Â  Â  Â  Â  Â  Â  minute: '2-digit'
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }

Â  Â  Â  Â  function formatDate(date) {
Â  Â  Â  Â  Â  Â  return date.toLocaleDateString('en-IN', {
Â  Â  Â  Â  Â  Â  Â  Â  day: '2-digit',
Â  Â  Â  Â  Â  Â  Â  Â  month: '2-digit',
Â  Â  Â  Â  Â  Â  Â  Â  year: 'numeric'
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }

Â  Â  Â  Â  function formatTime(date) {
Â  Â  Â  Â  Â  Â  return date.toLocaleTimeString('en-IN', {
Â  Â  Â  Â  Â  Â  Â  Â  hour: '2-digit',
Â  Â  Â  Â  Â  Â  Â  Â  minute: '2-digit'
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }

Â  Â  Â  Â  function calculateDuration(startTime, endTime) {
Â  Â  Â  Â  Â  Â  const diff = endTime - startTime;
Â  Â  Â  Â  Â  Â  const hours = Math.floor(diff / (1000 * 60 * 60));
Â  Â  Â  Â  Â  Â  const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));

Â  Â  Â  Â  Â  Â  if (hours === 0) {
Â  Â  Â  Â  Â  Â  Â  Â  return `${minutes}m`;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  return `${hours}h ${minutes}m`;
Â  Â  Â  Â  }

Â  Â  Â  Â  // Table Update Functions
Â  Â  Â  Â  function updateActiveLoansTable() {
Â  Â  Â  Â  Â  Â  const tbody = document.getElementById('activeLoansBody');
Â  Â  Â  Â  Â  Â  if (activeLoans.length === 0) {
Â  Â  Â  Â  Â  Â  Â  Â  tbody.innerHTML = '<tr><td colspan="7" style="text-align: center; padding: 30px;">No active loans</td></tr>';
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  tbody.innerHTML = activeLoans.map(loan => {
Â  Â  Â  Â  Â  Â  Â  Â  const duration = calculateDuration(loan.outTime, new Date());
Â  Â  Â  Â  Â  Â  Â  Â  return `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td>${loan.rollNo}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td>${loan.name}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td>${loan.roomNo}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td>${loan.equipment}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td>${formatDateTime(loan.outTime)}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td>${duration}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td><button class="return-btn" onclick="returnEquipment(${loan.id})">Return</button></td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </tr>
Â  Â  Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  }).join('');
Â  Â  Â  Â  }

Â  Â  Â  Â  function updateTransactionTable() {
Â  Â  Â  Â  Â  Â  const tbody = document.getElementById('transactionBody');
Â  Â  Â  Â  Â  Â  if (transactions.length === 0) {
Â  Â  Â  Â  Â  Â  Â  Â  tbody.innerHTML = '<tr><td colspan="8" style="text-align: center; padding: 30px;">No transactions yet</td></tr>';
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  tbody.innerHTML = transactions.map(transaction => {
Â  Â  Â  Â  Â  Â  Â  Â  const duration = transaction.inTime ?
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  calculateDuration(transaction.outTime, transaction.inTime) :
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  calculateDuration(transaction.outTime, new Date());

Â  Â  Â  Â  Â  Â  Â  Â  return `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td>${formatDate(transaction.outTime)}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td>${transaction.rollNo}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td>${transaction.name}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td>${transaction.equipment}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td>${formatTime(transaction.outTime)}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td>${transaction.inTime ? formatTime(transaction.inTime) : '-'}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td>${duration}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td><span class="status-${transaction.status}">${transaction.status.toUpperCase()}</span></td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </tr>
Â  Â  Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  }).join('');
Â  Â  Â  Â  }

Â  Â  Â  Â  // Core Application Functions
Â  Â  Â  Â  async function loadStudentDatabase() {
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  const response = await fetch('check.xlsx');
Â  Â  Â  Â  Â  Â  Â  Â  if (!response.ok) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  throw new Error(`Could not find check.xlsx (Status: ${response.status})`);
Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  const arrayBuffer = await response.arrayBuffer();
Â  Â  Â  Â  Â  Â  Â  Â  const workbook = XLSX.read(arrayBuffer, {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  type: 'array'
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
Â  Â  Â  Â  Â  Â  Â  Â  const jsonData = XLSX.utils.sheet_to_json(firstSheet);

Â  Â  Â  Â  Â  Â  Â  Â  if (jsonData.length === 0) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  throw new Error('The check.xlsx file appears to be empty');
Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  studentsData = {};
Â  Â  Â  Â  Â  Â  Â  Â  jsonData.forEach((row, index) => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const rollNo = String(
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  row['Roll No'] ||
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  row['RollNo'] ||
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  row['roll_no'] ||
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  row['Roll Number'] ||
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  row['ID'] ||
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  row['id'] ||
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ''
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ).trim();

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (rollNo) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  studentsData[rollNo] = {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  name: row['Name'] || row['name'] || row['Student Name'] || `Student ${index + 1}`,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  rollNo: rollNo,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  roomNo: String(
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  row['Room No'] ||
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  row['RoomNo'] ||
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  row['room_no'] ||
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  row['Room Number'] ||
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  row['Room'] ||
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ''
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ),
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  phoneNo: String(
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  row['Phone Number'] ||
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  row['PhoneNo'] ||
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  row['phone_no'] ||
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  row['Phone'] ||
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  row['Mobile'] ||
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  row['Contact'] ||
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ''
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  )
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  Â  Â  if (Object.keys(studentsData).length === 0) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  throw new Error('No valid student records found in check.xlsx');
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  } catch (error) {
Â  Â  Â  Â  Â  Â  Â  Â  console.error('Error loading student database:', error);
Â  Â  Â  Â  Â  Â  Â  Â  const rollNoInput = document.getElementById('rollNo');
Â  Â  Â  Â  Â  Â  Â  Â  rollNoInput.placeholder = `Error: ${error.message}`;
Â  Â  Â  Â  Â  Â  Â  Â  rollNoInput.style.color = '#e74c3c';
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function lookupStudent() {
Â  Â  Â  Â  Â  Â  const rollNo = document.getElementById('rollNo').value.trim();

Â  Â  Â  Â  Â  Â  if (!rollNo) {
Â  Â  Â  Â  Â  Â  Â  Â  showStatus('issueStatus', 'Please enter a roll number', 'error');
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  if (Object.keys(studentsData).length === 0) {
Â  Â  Â  Â  Â  Â  Â  Â  showStatus('issueStatus', 'Student database not loaded. Please check if check.xlsx is available.', 'error');
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  if (!studentsData[rollNo]) {
Â  Â  Â  Â  Â  Â  Â  Â  showStatus('issueStatus', 'Student not found. Please check the roll number.', 'error');
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('studentInfo').style.display = 'none';
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  const student = studentsData[rollNo];
Â  Â  Â  Â  Â  Â  document.getElementById('studentName').textContent = student.name;
Â  Â  Â  Â  Â  Â  document.getElementById('studentRoll').textContent = student.rollNo;
Â  Â  Â  Â  Â  Â  document.getElementById('studentRoom').textContent = student.roomNo;
Â  Â  Â  Â  Â  Â  document.getElementById('studentPhone').textContent = student.phoneNo;

Â  Â  Â  Â  Â  Â  document.getElementById('studentInfo').style.display = 'block';
Â  Â  Â  Â  Â  Â  showStatus('issueStatus', 'Student found! Select equipment to issue.', 'success');
Â  Â  Â  Â  }

Â  Â  Â  Â  function issueEquipment() {
Â  Â  Â  Â  Â  Â  const rollNo = document.getElementById('rollNo').value.trim();
Â  Â  Â  Â  Â  Â  const facilityType = document.getElementById('facilityType').value;
Â  Â  Â  Â  Â  Â  let equipment = facilityType;

Â  Â  Â  Â  Â  Â  if (!studentsData[rollNo]) {
Â  Â  Â  Â  Â  Â  Â  Â  showStatus('issueStatus', 'Please look up student first', 'error');
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  if (!facilityType) {
Â  Â  Â  Â  Â  Â  Â  Â  showStatus('issueStatus', 'Please select a facility type', 'error');
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  // Check if the selected facility is 'Sports' and get the specific equipment
Â  Â  Â  Â  Â  Â  if (facilityType === 'Sports') {
Â  Â  Â  Â  Â  Â  Â  Â  const sportsEquipment = document.getElementById('sportsEquipment').value;
Â  Â  Â  Â  Â  Â  Â  Â  if (!sportsEquipment) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  showStatus('issueStatus', 'Please select a specific sports equipment', 'error');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  equipment = sportsEquipment;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  // Check if student already has an active loan
Â  Â  Â  Â  Â  Â  const existingLoan = activeLoans.find(loan => loan.rollNo === rollNo && loan.status === 'active');
Â  Â  Â  Â  Â  Â  if (existingLoan) {
Â  Â  Â  Â  Â  Â  Â  Â  showStatus('issueStatus', 'Student already has an active equipment loan', 'error');
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  const student = studentsData[rollNo];
Â  Â  Â  Â  Â  Â  const currentTime = new Date();
Â  Â  Â  Â  Â  Â  const transaction = {
Â  Â  Â  Â  Â  Â  Â  Â  id: Date.now(),
Â  Â  Â  Â  Â  Â  Â  Â  rollNo: rollNo,
Â  Â  Â  Â  Â  Â  Â  Â  name: student.name,
Â  Â  Â  Â  Â  Â  Â  Â  roomNo: student.roomNo,
Â  Â  Â  Â  Â  Â  Â  Â  phoneNo: student.phoneNo,
Â  Â  Â  Â  Â  Â  Â  Â  equipment: equipment,
Â  Â  Â  Â  Â  Â  Â  Â  outTime: currentTime,
Â  Â  Â  Â  Â  Â  Â  Â  inTime: null,
Â  Â  Â  Â  Â  Â  Â  Â  status: 'active'
Â  Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  Â  transactions.unshift(transaction);
Â  Â  Â  Â  Â  Â  activeLoans.unshift(transaction);

Â  Â  Â  Â  Â  Â  updateActiveLoansTable();
Â  Â  Â  Â  Â  Â  updateTransactionTable();

Â  Â  Â  Â  Â  Â  showStatus('issueStatus', `Equipment "${equipment}" issued to ${student.name} successfully!`, 'success');

Â  Â  Â  Â  Â  Â  // Reset form
Â  Â  Â  Â  Â  Â  document.getElementById('rollNo').value = '';
Â  Â  Â  Â  Â  Â  document.getElementById('facilityType').value = '';
Â  Â  Â  Â  Â  Â  document.getElementById('studentInfo').style.display = 'none';
            document.getElementById('sportsEquipmentGroup').style.display = 'none';
Â  Â  Â  Â  }

Â  Â  Â  Â  function returnEquipment(transactionId) {
Â  Â  Â  Â  Â  Â  const loanIndex = activeLoans.findIndex(loan => loan.id === transactionId);
Â  Â  Â  Â  Â  Â  const transactionIndex = transactions.findIndex(t => t.id === transactionId);

Â  Â  Â  Â  Â  Â  if (loanIndex !== -1 && transactionIndex !== -1) {
Â  Â  Â  Â  Â  Â  Â  Â  const returnTime = new Date();
Â  Â  Â  Â  Â  Â  Â  Â  activeLoans[loanIndex].inTime = returnTime;
Â  Â  Â  Â  Â  Â  Â  Â  activeLoans[loanIndex].status = 'returned';

Â  Â  Â  Â  Â  Â  Â  Â  transactions[transactionIndex].inTime = returnTime;
Â  Â  Â  Â  Â  Â  Â  Â  transactions[transactionIndex].status = 'returned';

Â  Â  Â  Â  Â  Â  Â  Â  // Remove from active loans
Â  Â  Â  Â  Â  Â  Â  Â  activeLoans.splice(loanIndex, 1);

Â  Â  Â  Â  Â  Â  Â  Â  updateActiveLoansTable();
Â  Â  Â  Â  Â  Â  Â  Â  updateTransactionTable();
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  // Initial Setup
Â  Â  Â  Â  window.addEventListener('load', () => {
Â  Â  Â  Â  Â  Â  loadStudentDatabase();
            document.getElementById('facilityType').addEventListener('change', function() {
                const sportsEquipmentGroup = document.getElementById('sportsEquipmentGroup');
                if (this.value === 'Sports') {
                    sportsEquipmentGroup.style.display = 'block';
                } else {
                    sportsEquipmentGroup.style.display = 'none';
                }
            });
Â  Â  Â  Â  Â  Â  // Auto-refresh active loans duration every minute
Â  Â  Â  Â  Â  Â  setInterval(() => {
Â  Â  Â  Â  Â  Â  Â  Â  if (activeLoans.length > 0) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  updateActiveLoansTable();
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }, 60000);
Â  Â  Â  Â  });
Â  Â  </script>
</body>
</html>
